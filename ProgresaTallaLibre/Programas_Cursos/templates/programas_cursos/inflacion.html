{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curso de Inflaci√≥n - Progresa Libre</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body class="page-inflacion">
    <div class="container">
        <div class="header">
            <button class="back-btn" onclick="goToCourses()">
                ‚Üê Mis Cursos
            </button>
            <h1>üìä Curso de Inflaci√≥n</h1>
            <p>Comprende los fundamentos de la inflaci√≥n, sus causas, efectos y c√≥mo impacta en la econom√≠a y tu vida diaria. Un curso interactivo con videos y ejercicios pr√°cticos.</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('lecciones')">üìö Lecciones</button>
            <button class="tab" onclick="showTab('documentacion')">üìñ Documentaci√≥n</button>
            <button class="tab" onclick="showTab('ejercicios')">‚úèÔ∏è Ejercicios</button>
            <button class="tab" onclick="showTab('evaluaciones')">üéØ Evaluaciones</button>
        </div>

        <div class="content">
            <!-- Tab de Lecciones -->
            <div id="lecciones" class="tab-content active">
                <div class="section-intro">
                    <h2>Lecciones Interactivas</h2>
                    <p>Cada lecci√≥n incluye un video con preguntas interactivas que te ayudar√°n a reforzar los conceptos clave. Completa las lecciones en orden para una mejor comprensi√≥n.</p>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 0%"></div>
                </div>

                <div class="lesson-grid">
                    <div class="lesson-card" onclick="openLesson(1)">
                        <span class="lesson-number">Lecci√≥n 1</span>
                        <h3>¬øQu√© es la Inflaci√≥n?</h3>
                        <p>Introducci√≥n al concepto de inflaci√≥n, definici√≥n b√°sica y ejemplos cotidianos.</p>
                    </div>

                    <div class="lesson-card" onclick="openLesson(2)">
                        <span class="lesson-number">Lecci√≥n 2</span>
                        <h3>Causas de la Inflaci√≥n</h3>
                        <p>Inflaci√≥n por demanda, costos y expectativas. Factores estructurales y coyunturales.</p>
                    </div>

                    <div class="lesson-card" onclick="openLesson(3)">
                        <span class="lesson-number">Lecci√≥n 3</span>
                        <h3>Medici√≥n de la Inflaci√≥n</h3>
                        <p>IPC, IPM y otros √≠ndices. C√≥mo se calcula y qu√© nos indica cada medida.</p>
                    </div>

                    <div class="lesson-card" onclick="openLesson(4)">
                        <span class="lesson-number">Lecci√≥n 4</span>
                        <h3>Efectos de la Inflaci√≥n</h3>
                        <p>Impacto en el poder adquisitivo, ahorro, inversi√≥n y distribuci√≥n del ingreso.</p>
                    </div>

                    <div class="lesson-card" onclick="openLesson(5)">
                        <span class="lesson-number">Lecci√≥n 5</span>
                        <h3>Pol√≠tica Monetaria</h3>
                        <p>Rol de los bancos centrales, tasas de inter√©s y control de la inflaci√≥n.</p>
                    </div>

                    <div class="lesson-card" onclick="openLesson(6)">
                        <span class="lesson-number">Lecci√≥n 6</span>
                        <h3>Hiperinflaci√≥n y Deflaci√≥n</h3>
                        <p>Casos extremos, ejemplos hist√≥ricos y consecuencias econ√≥micas.</p>
                    </div>
                </div>
            </div>

            <!-- Tab de Documentaci√≥n -->
            <div id="documentacion" class="tab-content">
                <div class="section-intro">
                    <h2>Material de Apoyo</h2>
                    <p>Recursos complementarios para profundizar en los temas del curso.</p>
                </div>

                <ul class="doc-list">
                    <li class="doc-item">
                        <h3>üìò Macroeconom√≠a - N. Gregory Mankiw</h3>
                        <p>Cap√≠tulos 4-6: Teor√≠a cuantitativa del dinero e inflaci√≥n</p>
                        <a href="{% static 'pdf/Macroeconomia__Gregory_Mankiw.pdf' %}" target="_blank" class="doc-link">Descargar PDF ‚Üí</a>
                    </li>
                    <li class="doc-item">
                        <h3>üìó Econom√≠a - Paul Samuelson</h3>
                        <p>Parte III: Macroeconom√≠a moderna y pol√≠tica econ√≥mica</p>
                        <a href="#" class="doc-link">Descargar PDF ‚Üí</a>
                    </li>
                    <li class="doc-item">
                        <h3>üìô Inflaci√≥n y Estabilidad Macroecon√≥mica - BID</h3>
                        <p>Documento t√©cnico sobre pol√≠ticas antiinflacionarias en Am√©rica Latina</p>
                        <a href="#" class="doc-link">Descargar PDF ‚Üí</a>
                    </li>
                    <li class="doc-item">
                        <h3>üìï Reportes del Banco Central</h3>
                        <p>Informes de pol√≠tica monetaria y an√°lisis de inflaci√≥n actualizados</p>
                        <a href="#" class="doc-link">Descargar PDF ‚Üí</a>
                    </li>
                    <li class="doc-item">
                        <h3>üì∞ Art√≠culos Acad√©micos Recomendados</h3>
                        <p>Selecci√≥n de papers sobre inflaci√≥n contempor√°nea y casos de estudio</p>
                        <a href="#" class="doc-link">Descargar PDF ‚Üí</a>
                    </li>
                </ul>
            </div>

            <!-- Tab de Ejercicios -->
            <div id="ejercicios" class="tab-content">
                <div class="section-intro">
                    <h2>Ejercicios Pr√°cticos</h2>
                    <p>Pon a prueba tu comprensi√≥n con estos ejercicios aplicados.</p>
                </div>

                <div class="exercise-card">
                    <h3>Ejercicio 1: C√°lculo del IPC</h3>
                    <p>Dada una canasta de bienes y servicios, calcula la variaci√≥n del √≠ndice de precios al consumidor entre dos per√≠odos.</p>
                    <a class="btn-start" href="{% static 'pdf/guia_ipc_mejorada.pdf' %}" target="_blank">Ver gu√≠a</a>
                </div>

                <div class="exercise-card">
                    <h3>Ejercicio 2: Inflaci√≥n y Poder Adquisitivo</h3>
                    <p>Determina c√≥mo afecta una inflaci√≥n del 5% anual al poder de compra de un salario fijo durante 3 a√±os.</p>
                    <a class="btn-start" href="{% static 'pdf/guia_ipc_mejorada.pdf' %}" target="_blank">Ver gu√≠a</a>
                </div>

                <div class="exercise-card">
                    <h3>Ejercicio 3: An√°lisis de Pol√≠ticas Monetarias</h3>
                    <p>Analiza casos de intervenci√≥n del banco central y sus efectos en la inflaci√≥n.</p>
                     <a class="btn-start" href="{% static 'pdf/guia_ipc_mejorada.pdf' %}" target="_blank">Ver gu√≠a</a>
                </div>

                <div class="exercise-card">
                    <h3>Ejercicio 4: Estudio de Caso - Hiperinflaci√≥n</h3>
                    <p>Investiga un caso hist√≥rico de hiperinflaci√≥n y sus causas fundamentales.</p>
                    <a class="btn-start" href="{% static 'pdf/guia_ipc_mejorada.pdf' %}" target="_blank">Ver gu√≠a</a>
                </div>
            </div>

            <!-- Tab de Evaluaciones -->
            <div id="evaluaciones" class="tab-content">
                <div class="section-intro">
                    <h2>Sistema de Evaluaci√≥n</h2>
                    <p>Eval√∫a tu aprendizaje con quizzes por tema y un control final integrador.</p>
                </div>

                <div class="quiz-card" data-quiz-id="1">
                    <div class="quiz-info">
                        <h3>Quiz 1: Conceptos B√°sicos</h3>
                        <p>Definici√≥n de inflaci√≥n y conceptos fundamentales</p>
                        <p><strong>10 preguntas ‚Ä¢ 15 minutos</strong></p>
                        <a href="{% url 'cursos:evaluaciones_inflacion' %}" class="btn-start">Iniciar Quiz</a>
                        <div id="quiz1-result" class="quiz-result-container"></div>
                    </div>
                    <div class="quiz-result" id="result-quiz-1" style="display: none;"></div>
                </div>

                <div class="quiz-card" data-quiz-id="2">
                    <div class="quiz-info">
                        <h3>Quiz 2: Causas y Medici√≥n</h3>
                        <p>Factores causales y m√©todos de medici√≥n de la inflaci√≥n</p>
                        <p><strong>12 preguntas ‚Ä¢ 20 minutos</strong></p>
                        <a href="" class="btn-start">Pr√≥ximamente</a>
                    </div>
                    <div class="quiz-result" id="result-quiz-2" style="display: none;"></div>
                </div>

                <div class="quiz-card" data-quiz-id="3">
                    <div class="quiz-info">
                        <h3>Quiz 3: Efectos y Pol√≠ticas</h3>
                        <p>Consecuencias econ√≥micas y pol√≠ticas antiinflacionarias</p>
                        <p><strong>15 preguntas ‚Ä¢ 25 minutos</strong></p>
                        <a href="" class="btn-start">Pr√≥ximamente</a>
                    </div>
                    <div class="quiz-result" id="result-quiz-3" style="display: none;"></div>
                </div>

                <div class="quiz-card quiz-final" data-quiz-id="final">
                    <div class="quiz-info">
                        <h3>üèÜ Control Final</h3>
                        <p>Evaluaci√≥n integradora de todos los contenidos del curso</p>
                        <p><strong>30 preguntas ‚Ä¢ 45 minutos ‚Ä¢ Requiere 70% para aprobar</strong></p>
                        <a href="" class="btn-start">Pr√≥ximamente</a>
                    </div>
                    <div class="quiz-result" id="result-quiz-final" style="display: none;"></div>
                </div>
        </div>
    </div>

    <!-- Modal para videos H5P -->
    <div id="videoModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeVideo()">‚úï Cerrar</button>
            <div class="video-wrapper" id="videoContent">
                <!-- El contenido H5P se carga aqu√≠ -->
            </div>
        </div>
    </div>

    <!-- Script H5P Resizer -->
    <script src="https://progresalibre.h5p.com/js/h5p-resizer.js" charset="UTF-8"></script>

    <script>
        // ========================================
        // CONFIGURACI√ìN DE LECCIONES H5P
        // ========================================
        // INSTRUCCIONES PARA AGREGAR TUS VIDEOS:
        // 1. Crea tu contenido en progresalibre.h5p.com (Interactive Video)
        // 2. Agrega tu video de YouTube
        // 3. Inserta preguntas en los minutos clave
        // 4. Copia el "src" del iframe embed
        // 5. P√©galo en h5pURL abajo (solo la URL, sin el <iframe>)
        
        const lessonData = {
            1: {
                title: "¬øQu√© es la Inflaci√≥n?",
                description: "Introducci√≥n al concepto de inflaci√≥n, definici√≥n b√°sica y ejemplos cotidianos de c√≥mo afecta tu vida diaria.",
                h5pURL: "https://progresalibre.h5p.com/content/TU_CODIGO_AQUI/embed",
                // üëÜ EJEMPLO COMPLETADO - Reemplaza con tu URL real
            },
            2: {
                title: "Causas de la Inflaci√≥n",
                description: "Inflaci√≥n por demanda, costos y expectativas. Factores estructurales y coyunturales que generan inflaci√≥n.",
                h5pURL: "https://progresalibre.h5p.com/content/TU_CODIGO_AQUI/embed",
                // üëÜ REEMPLAZA "TU_CODIGO_AQUI" con el c√≥digo de tu video H5P
            },
            3: {
                title: "Medici√≥n de la Inflaci√≥n",
                description: "IPC, IPM y otros √≠ndices. C√≥mo se calcula la inflaci√≥n y qu√© nos indica cada medida econ√≥mica.",
                h5pURL: "https://progresalibre.h5p.com/content/TU_CODIGO_AQUI/embed",
                // üëÜ REEMPLAZA "TU_CODIGO_AQUI" con el c√≥digo de tu video H5P
            },
            4: {
                title: "Efectos de la Inflaci√≥n",
                description: "Impacto en el poder adquisitivo, ahorro, inversi√≥n y distribuci√≥n del ingreso en la econom√≠a.",
                h5pURL:  "https://progresalibre.h5p.com/content/1292744445782732078/embed"
                // üëÜ REEMPLAZA "TU_CODIGO_AQUI" con el c√≥digo de tu video H5P
            },
            5: {
                title: "Pol√≠tica Monetaria",
                description: "Rol de los bancos centrales, tasas de inter√©s y herramientas para el control de la inflaci√≥n.",
                h5pURL: "https://progresalibre.h5p.com/content/TU_CODIGO_AQUI/embed",
                // üëÜ REEMPLAZA "TU_CODIGO_AQUI" con el c√≥digo de tu video H5P
            },
            6: {
                title: "Hiperinflaci√≥n y Deflaci√≥n",
                description: "Casos extremos de inflaci√≥n y deflaci√≥n, ejemplos hist√≥ricos y sus consecuencias econ√≥micas devastadoras.",
                h5pURL: "https://progresalibre.h5p.com/content/TU_CODIGO_AQUI/embed",
                // üëÜ REEMPLAZA "TU_CODIGO_AQUI" con el c√≥digo de tu video H5P
            }
        };

        // ========================================
        // FUNCIONES DEL SISTEMA
        // ========================================
        
        function showTab(tabName) {
            // Ocultar todos los contenidos
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));

            // Desactivar todos los tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Activar el tab seleccionado
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function goToCourses() {
            window.location.href = "{% url 'usuarios:micursos' %}";
            
        }

        function openLesson(lessonNumber) {
            const lesson = lessonData[lessonNumber];
            
            if (!lesson) {
                alert('Lecci√≥n no encontrada');
                return;
            }

            // Construir el contenido del modal con el iframe H5P
            const videoHTML = `
                <h2>Lecci√≥n ${lessonNumber}: ${lesson.title}</h2>
                <p>${lesson.description}</p>
                <div class="h5p-container">
                    <iframe src="${lesson.h5pURL}" 
                            class="h5p-iframe"
                            aria-label="${lesson.title}"
                            frameborder="0" 
                            allowfullscreen="allowfullscreen"
                            allow="autoplay *; geolocation *; microphone *; camera *; midi *; encrypted-media *">
                    </iframe>
                </div>
            `;
            
            document.getElementById('videoContent').innerHTML = videoHTML;
            document.getElementById('videoModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeVideo() {
            document.getElementById('videoModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Cerrar modal con tecla ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeVideo();
            }
        });

        // Simular progreso del curso
        setTimeout(() => {
            document.querySelector('.progress-fill').style.width = '16%';
        }, 500);

        function showResults(score, correctAnswers, passed) {
            document.getElementById('quizScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.add('active');
            
            const iconDiv = document.getElementById('resultIcon');
            if (passed) {
                iconDiv.innerHTML = '<span class="icon-trophy">üèÜ</span>';
            } else {
                iconDiv.innerHTML = '‚ùå';
            }
            
            document.getElementById('resultTitle').textContent = 
                passed ? '¬°Felicitaciones!' : 'Sigue intentando';
            
            const scoreNum = document.getElementById('scoreNumber');
            scoreNum.textContent = score + '%';
            scoreNum.className = 'score-number ' + (passed ? 'score-pass' : 'score-fail');
            
            document.getElementById('scoreLabel').textContent = 
                passed ? 'Has aprobado el quiz' : 'No has alcanzado la nota m√≠nima';
            
            document.getElementById('correctAnswers').textContent = 
                `Respuestas correctas: ${correctAnswers} de ${quiz.totalQuestions}`;
            
            // Enviar mensaje al padre (si est√° en iframe)
            if (window.parent !== window) {
                window.parent.postMessage({
                    type: 'quiz_completed',
                    quizId: 1,
                    score: score,
                    passed: passed,
                    correctAnswers: correctAnswers,
                    totalQuestions: quiz.totalQuestions
                }, '*');
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            const score = localStorage.getItem('quiz1_score');
            const passed = localStorage.getItem('quiz1_passed') === 'true';
            const correct = localStorage.getItem('quiz1_correct');
            const total = localStorage.getItem('quiz1_total');

            const container = document.getElementById("quiz1-result");

            // Si NO hay resultados, no mostramos nada
            if (!score) return;

            container.innerHTML = `
                <div class="quiz-result ${passed ? 'passed' : 'failed'}">
                    <span class="quiz-result-icon">${passed ? '‚úì' : '‚úó'}</span>
                    <div class="quiz-result-text">
                        <strong>${passed ? 'Aprobado' : 'Reprobado'}</strong><br>
                        ${score}% ‚Äî ${correct} de ${total} correctas
                    </div>
                </div>
            `;

        });        
    </script>
</body>
</html>